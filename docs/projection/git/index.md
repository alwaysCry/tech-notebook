# Git

## 基本概念

- **blob**：或称二进制大对象/数据对象，Git 以此形式存储文件内容，以 SHA-1 唯一标识

- **树对象（tree**）：相当于目录，引用着 blob 与其他树对象，以 SHA-1 唯一标识

- **提交（commit）**：提交对象的简称，包含指向（根目录）树对象的指针及一些元数据（提交者、提交信息、提交时间...）。可理解为工作目录的一个快照，以 SHA-1 唯一标识（即`git log`时所见）

- **分支（branch）**：对提交的命名引用，始终指向所在提交链上的最近一次提交；而**活动分支（active branch）**，即当前所在分支，由特殊指针 HEAD 指向（**后者也能直接指向一个提交**）

- **仓库（repository）**：本质是一系列提交的集合

- **暂存区（staging area）**：或称索引（index），用于注册改动以待一并提交

- **工作目录（working dir）**：或称工作树（working tree），关联着一个仓库，即一般理解的“项目”

## XXX

通常有两种获取 Git 仓库的方式：

- 本地初始化：在项目根目录下执行`git init`
  <!-- TODO：了解：Git hook、Git支持的数据传输协议-->
- 远程克隆：`git clone <url>`，会克隆服务器中指定仓库的几乎所有数据，部分服务器钩子（hook）除外

工作目录（working dir）或称工作树（working tree），可理解为“项目”，即与 Git 仓库关联，其下每一文件均为以下状态之一：

- 未跟踪（untracked），可通过`git add`命令转为已暂存

- 已跟踪（tracked），又可分为：

  - 暂存（staged）

  - 已修改（modified）

## 基本设置

- Git 具有以下配置文件，按优先级从高到低分别对应`git config`命令的不同选项：

  - `.git/config`：仓库级配置，对应默认或`--local`选项（须在对应工作目录下）

  - `~/.gitconfig`或`~/.config/git/config`：用户级配置（适用其所有仓库），对应`--global`选项

  - `/etc/gitconfig`：系统级配置（含所有用户），对应`--system`选项

- 设置默认编辑器，按优先级高到低：

  - 通过`git config core.editor`设置

  - 由 Shell 环境变量`EDITOR`指定

## 常用命令

<!-- - `git config`：读取或设置 Git 配置 -->

- `git add <file>`：将指定文件添加至（待）下一次提交中（`<file>`为目录则递归处理其下所有文件），根据文件的不同状态：

  - 未跟踪文件将被跟踪

  - 将已跟踪文件的改动注册至暂存区

  - 将有冲突的文件标记为已解决

- `git status`：概览工作目录下各文件的状态

  - `-s`/`--short`：紧凑化输出，以下列标记对应不同状态（红/绿色分别表示未注册/已注册至暂存区）：

    - `??`：新增的未跟踪文件

    - `A`：新跟踪的文件

    - `M`：有修改内容的文件

    - `AM`：新跟踪且之后又有修改内容的文件

    - `D`：被删除的文件

    - `R`：被重命名（移动）的文件

- `git commit [<file>|]`：启动默认文本编辑器，待退出后以其中输入（忽略注释）为说明信息执行提交。若指定`<file>`（且其已跟踪）则注册其所有改动后一并提交，否则只提交暂存区内的所有改动

  - `-m`：直接附带说明信息来执行提交（不启动编辑器）

  - `-a`：自动注册所有被改动的**已跟踪**文件，一并提交（跳过`git add`步骤）

- `git rm <file>`：默认删除**已跟踪且未注册改动**的文件，可以 glob
  模式匹配

  - `-r`：指定目录以递归删除

  - `-f`/`--fore`：已注册改动文件的也将被删除（其注册于暂存区的改动将替换为已删除）

  - `--cached`：仅在暂存区中将文件注册删除，工作目录中仍保留（如一些本该`.gitignore`的文件）

- `git mv <src> <dest>`：移动（重命名）文件，相当于依次执行了：`mv <src> <dest>`、`git rm <src>`、`git add <dest>`

- `git log`：按时间从后往前列出所有提交

  -`-<N>`：仅列出最近的 N 条提交

  - `--since`/`--after`：列出指定时间（`yyyy-mm-dd`，下同）之后的提 i 交

  - `--until`/`--before`：列出指定时间之前的提交
